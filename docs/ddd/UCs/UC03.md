# UC-03 — Approvisionnement du portefeuille (dépôt virtuel)

## Objectif
Permettre aux utilisateurs d’augmenter le solde de leur portefeuille virtuel en réalisant des dépôts simulés, afin de garantir la disponibilité des fonds nécessaires pour placer des ordres d’achat sur la plateforme BrokerX.

## Acteur principal
Client

## Acteurs secondaires
Service Paiement Simulé

## Déclencheur
Le Client crédite son solde en monnaie fiduciaire simulée.

## Pré-conditions
Le compte du Client doit être au statut "ACTIVE".

## Postconditions (succès)
- Le solde du portefeuille est augmenté.
- Une écriture précise de la transaction effectuée est ajoutée au journal.

## Postconditions (échec)
- Le solde du portefeuille reste inchangé.
- Une écriture d’erreur est ajoutée au journal avec le motif de l’échec.

## Flux principal
1. Le Client saisit le montant à déposer.
2. Le Système vérifie les limites (montant minimum/maximum).
3. Le Système crée une transaction avec le statut "PENDING".
4. Le Service Paiement Simulé traite la demande et répond "SETTLED".
5. Le Système crédite le portefeuille, journalise la transaction et notifie le Client du résultat de l'opération.

## Alternatifs / Exceptions
E1. **Paiement rejeté** : La transaction passe au statut "FAILED" et le Client reçoit une notification avec le motif du rejet.\
E2. **Idempotence** : Si une demande de dépôt avec la même idempotency-key, le Système renvoie le résultat précédent.\
E3. **Montant hors limites** : Si le montant est inférieur au minimum ou supérieur au maximum autorisé, le dépôt est refusé et le Client est informé.\
E4. **Compte non trouvé ou non actif** : Si le compte n’existe pas ou n’est pas au statut "ACTIVE", le dépôt est refusé.

---
**Critère d’acceptation** :
Un client saisit un montant valide, la transaction est acceptée, le portefeuille est crédité, et la transaction est journalisée avec succès.
