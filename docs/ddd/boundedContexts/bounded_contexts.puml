@startuml
skinparam packageStyle rectangle

package "Utilisateur & Sécurité" {
  rectangle "User"
  rectangle "MfaChallenge"
  rectangle "SessionToken"
  rectangle "Registration"
  rectangle "Notifications"

  User -down-> SessionToken
  User -down-> MfaChallenge: "Valide"
  User -down-> Registration: "Effectue"
  MfaChallenge -down-> SessionToken: "Possède"
  User -down-> Notifications: "Reçoit"
}

package "Portefeuille" {
  rectangle "Wallet"
  rectangle "Transaction"
  rectangle "Positions"
  rectangle "SimulatedPayment"
  rectangle "Solde"

  Wallet -down-> Transaction: "Est alimenté par"
  Transaction -down-> SimulatedPayment: "Est confirmée par"
  Transaction -down-> Solde: "Modifie"
  Wallet -down-> Positions: "Contient"
}

package "Ordres" {
  rectangle "Order"
  rectangle "PreTradeValidation"

  Order -down-> PreTradeValidation: "Est validé par"
}

package "Matching" {
  rectangle "OrderBook"
  rectangle "ExecutionReport"
  rectangle "MatchEngine"

  OrderBook -down-> MatchEngine: "Est traité par"
  MatchEngine -down-> ExecutionReport: "Déclenche un rapport d'exécution"
}

package "Données de Marché" {
  rectangle "Stocks"
  rectangle "StockPrice"

  Stocks -down-> StockPrice: "A un prix associé"
}

' Liaisons inter-contextes principales
User -right-> Wallet: "Possède"
User -right-> Order: "Place, Modifie, Annule"
Notifications -right-> ExecutionReport: "sont reçues de"
Wallet -down-> Order: "Est affecté par"
Order -down-> OrderBook: "Est ajouté au carnet"
Order -> Stocks: "Est placé sur"
Positions -down-> Stocks: "Inclut"

@enduml
